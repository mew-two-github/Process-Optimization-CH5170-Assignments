clear;
L1 = 300; L2 = 500; L3 = 400;
Ho = 100; beta = 89; gamma = 81.5; alpha = 79.5;
Q1  = 9; Q2 = 3; Q3 = 2;
d11 = 300; d12=350;
d21 = 200;d22 = 250;
d31 = 150; d32 = 200;
% LHS of the linear inequality constraint
A = zeros(9,3);
A(1,:) = [Q1^1.85/d11^4.87-Q1^1.85/d12^4.87 0 0]*(4.457*10^8);
A(2,:) = [Q1^1.85/d11^4.87-Q1^1.85/d12^4.87 Q2^1.85/d21^4.87-Q2^1.85/d22^4.87 0]*(4.457*10^8);
A(3,:) = [Q1^1.85/d11^4.87-Q1^1.85/d12^4.87 0 Q3^1.85/d31^4.87-Q3^1.85/d32^4.87]*(4.457*10^8);
A(4:6,:) = eye(3);
A(7:9,:) = -1*eye(3);
% RHS
B = zeros(9,1);
B(1) = (Ho-alpha) - L1*Q1^1.85/d12^4.87*(4.457*10^8);
B(2) = (Ho-beta) - L1*Q1^1.85/d12^4.87*(4.457*10^8) - L2*Q2^1.85/d22^4.87*(4.457*10^8);
B(3) = (Ho-gamma) - L1*Q1^1.85/d12^4.87*(4.457*10^8) - L3*Q3^1.85/d32^4.87*(4.457*10^8);
B(4) = L1; B(5) = L2; B(6) = L3;

% minimise costs
sol = fmincon(@cost,[0;300;400],A,B);
cost_sol = cost(sol);
% verification of solution
HA = Ho - 4.457*10^8*Q1^1.85*(sol(1)/d11^4.87 + (L1-sol(1))/d12^4.87);
HB = HA - 4.457*10^8*(Q2^1.85*(sol(2)/d21^4.87 + (L2-sol(2))/d22^4.87));
HC = HA - 4.457*10^8*(Q3^1.85*(sol(3)/d31^4.87 + (L3-sol(3))/d32^4.87));
function f = cost(x)
    L1 = 300; L2 = 500; L3 = 450;
    d11 = 300; d12=350;
    d21 = 200;d22 = 250;
    d31 = 150; d32 = 200;
    f = 1.2654*(x(1)*d11^1.327+(L1-x(1))*d12^1.327);
    f = f+ 1.2654*(x(2)*d21^1.327+(L2-x(2))*d22^1.327);
    f = f+ 1.2654*(x(3)*d31^1.327+(L3-x(3))*d32^1.327);
end
    